<!doctype html>
<html ng-app="iomTraining">

<head>
  <meta charset="utf-8" />
  <title>Acoustic Level</title>
  <script src="lib/angular.min.js"></script>
  <link rel="stylesheet" href="lib/bootstrap.min.css">
  <link rel="stylesheet" href="lib/rzslider.css"/>
  <script src="lib/ui-bootstrap-tpls.js"></script>
  <script src="lib/rzslider.js"></script>
  <script src="lib/BufferLoad.js"></script>
  <script src="lib/angular-dark-sky.js"></script>

  <script src="lib/utils.js"></script>
  <script src="lib/NoSleep.min.js"></script>
  <script src="app.js"></script>
  <script src="iomController.js"></script>

  <link rel="stylesheet" type="text/css" href="css/style.css"/>
  <link rel="stylesheet" type="text/css" href="css/weather-icons.min.css"/>
  <link rel="stylesheet" type="text/css" href="css/weather-icons-wind.min.css"/>
  <link href='https://fonts.googleapis.com/css?family=Cousine:700' rel='stylesheet' type='text/css'>
</head>

<body id="body">
  <div class="page" ng-controller="iomController">


    <div class = "buttons">

      <input type="button" ng-class="{redstyle: wakeLockEnabled}" ng-click='wake()' value="WakeLock" />
      <input type="button" ng-click='' value="Stats" />
      <input type="button" ng-click='' value="Export" />
      <input type="button" ng-class="{redstyle: showSettings}" ng-click='showSettings = !showSettings' value="Series" />
      <dark-sky-icon icon="{{ weather.currently.icon }}" ng-class="{redstyle: weatherDisplayed}" ng-click='showWeather()'></dark-sky-icon>

    </div>
      <div  ng-show="weatherDisplayed">
        <table class="weatherBox">
          <tr>
              <td ng-repeat="x in weather.data"><span  class="wi wi-wind {{x.windBearing}}" ></span></td>
          </tr>
        <tr>
            <td ng-repeat="x in weather.data">{{x.windSpeed}} ({{x.windGust}})</td>
        </tr>
        <tr>
            <td ng-repeat="x in weather.data"><dark-sky-icon icon="{{ x.icon }}"></dark-sky-icon></td>
        </tr>
      </table>

      </div>
    <div class="settingsBox" ng-show="showSettings">
      <h2 class='titles'>Legs</h2>
      <rzslider
      data-rz-slider-model="legSlider.value"
      data-rz-slider-options="legSlider.options"
      ></rzslider>

      <h2 class='titles'>Start procedure</h2>
      <rzslider
      data-rz-slider-model="startSlider.value"
      data-rz-slider-options="startSlider.options"
      ></rzslider>
       <h2 class='titles' ng-click="setDistance()" ng-class="{redstyle: firstPoint}" >Distance</h2>
        <rzslider
        data-rz-slider-model="distanceSlider.value"
        data-rz-slider-options="distanceSlider.options"
        ></rzslider>
    </div>



    <br>


    <svg id="raceDisplay" class="raceDisplay"  >
      <line x1="25%" y1="5%" x2="25%" y2="95%" style="stroke:black;" />
      <line x1="75%" y1="5%" x2="75%" y2="95%" style="stroke:black;" />

      <line x1="40%" y1="90%" x2="60%" y2="90%" style="stroke:black;" />
      <line x1="50%" y1="87%" x2="50%" y2="93%" style="stroke:black;" />

      <rect ng-repeat="a in race.events" " x="{{50+a.duration/1000}}%" y="85%" rx="10" ry="10" width="2%" height="{{10*(a.type==0)}}%" />


      <circle ng-show="upLeg&&started" cx="25%" cy="{{(1-currentDuration/(maxDuration*1.2))*90-5}}%"  r="6px" fill="red" />
      <circle ng-show="!upLeg&&started" cx="75%" cy="{{(currentDuration/(maxDuration*1.2))*90+5}}%"  r="6px" fill="red" />

      <rect ng-repeat="a in race.events"  x="{{25-5+a.delay/a.duration*5}}%" y="{{(1-a.duration/(maxDuration*1.2))*90-5}}%" rx="10" ry="10" width="{{10*(a.type==4)}}%" height="20px" />

      <text text-anchor="middle" ng-repeat="a in race.events" class="svgText" x="{{25+a.delay/a.duration*5}}%" y="{{(1-a.duration/(maxDuration*1.2))*90-5+3.5}}%" font-family="Verdana" font-size="{{20*(a.type==4)}}">
          {{a.leg}}
        </text>

      <rect ng-repeat="a in race.events"  x="{{75-5}}%" y="{{(a.duration/(maxDuration*1.2))*90+5}}%" rx="10" ry="10" width="{{10*(a.type==3)}}%" height="20px" />

      <text text-anchor="middle" ng-repeat="a in race.events" class="svgText" x="75%" y="{{(a.duration/(maxDuration*1.2))*90+5+3.5}}%" font-family="Verdana" font-size="{{20*(a.type==3)}}">
          {{a.leg}}
        </text>

    </svg>
    <div class="infoDisplay">



      <button class="wi wi-wind towards-0-deg" ng-click="startFunc()" ng-class="{redstyle: started&&tack==0}"> </button>
  <div ng-show="started">
      <br>  <br>
      <div class="legDisplay">
  {{legNumber}}
  </div>
  <br>
        <i class="wi wi-wind towards-315-deg" ng-class="{redstyle: started&&tack==2}"></i>
        <i class="wi wi-wind towards-45-deg" ng-class="{redstyle: started&&tack==1}"></i>
        <br>
        <i class="wi wi-wind towards-180-deg" ng-class="{redstyle: started&&tack==3}"></i>
        <br><br>
  </div>




    </div>
  </div>


</body>
</html>
